## 06. ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì†Œê°œ

### ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë¬¸ì œ í•´ê²°í•˜ê¸°

> [!IMPORTANT]
> ë¦¬ì•¡íŠ¸ëŠ” ì»´í¬ë„ŒíŠ¸ë¼ëŠ” ê°œë…ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ê³„ëê³ , ì»´í¬ë„ŒíŠ¸ ëª¨ë¸ì—ì„œëŠ” ëª¨ë“  ê²ƒì´ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê²ƒìœ¼ë¡œ ì—¬ê²¨ì§„ë‹¤.

ğŸ”« ê·¸ëŸ°ë°, ì§€ê¸ˆê¹Œì§€ ë‹¤ë£¬ ì „ì—­ ìƒíƒœëŠ” `ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€`ì— ì¡´ì¬í•œë‹¤. ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ì˜ì¡´ì„±ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•˜ë©´ ì „ì—­ ìƒíƒœë¥¼ í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ì§€ë§Œ ì „ì—­ ìƒíƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ë§¤ìš° í¸ë¦¬í•˜ê³  ìƒì‚°ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.

ê·¸ë ‡ê¸° ë•Œë¬¸ì—, ì „ì—­ ìƒíƒœë¥¼ ì„¤ê³„í•  ë•ŒëŠ” ë‘ ê°€ì§€ ë¬¸ì œì ì„ ê¼­ ì§šì–´ì•¼ í•œë‹¤ê³  ë§í•œë‹¤.

1. ì „ì—­ ìƒíƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ëª¨ë“  ê°’ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš°ê°€ ìˆëŠ”ë°, ì‚¬ì‹¤ ì „ì—­ ìƒíƒœê°€ ë°”ë€Œë©´ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ì„œ ë³€ê²½ëœ ê°’ì´ ì»´í¬ë„ŒíŠ¸ë‘ ê´€ë ¨ì´ ì—†ì–´ë„ ë°”ë€ë‹¤.
2. ì „ì—­ ìƒíƒœëŠ” ì—¬ëŸ¬ ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì¼ë¶€ëŠ” ì¤‘ì²©ëœ ê°ì²´ì¼ ìˆ˜ ìˆë‹¤. ì´ëŸ´ ë•Œ ì§ì ‘ ê°’ì„ ë³€ê²½í•˜ë©´ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•˜ê³  ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¦¬ë Œë”ë§í•  ë°©ë²•ì´ ì—†ì–´ì„œ ì¢‹ì§€ ì•Šë‹¤.

```tsx
// ì „ì—­ ìƒíƒœ ë³€ê²½ì„ ê°ì§€í•˜ê¸° ìœ„í•´ì„œ ì „ì—­ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
const createContainer = () => {
  let state = { a; 1, b: 2 };
  const getState = () => state;
  const setState = (...) => { ... };
  return { getState, setState };
};

const globalContainer = createContainer();
globalContainer.setState(...);
```

### ë°ì´í„° ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ê³¼ ì»´í¬ë„ŒíŠ¸ ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ ì‚¬ìš©í•˜ê¸°

#### ë°ì´í„° ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ ì´í•´í•˜ê¸°

ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„¤ê³„ ì‹œì— ë°ì´í„° ëª¨ë¸ì€ ì‹±ê¸€í†¤ìœ¼ë¡œ ê°€ì§ˆ ìˆ˜ ìˆê³ , ì²˜ë¦¬í•  ë°ì´í„°ê°€ ì´ë¯¸ ìˆì„ ìˆ˜ë„ ìˆë‹¤. ì´ ê²½ìš° ì»´í¬ë„ŒíŠ¸ë¥¼ ì •ì˜í•˜ê³  ë°ì´í„°ì™€ ì»´í¬ë„ŒíŠ¸ë¥¼ ì—°ê²°í•œë‹¤.

ì´ëŸ¬í•œ ë°ì´í„° ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ì „ì—­ ìƒíƒœ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ëª¨ë“ˆ ìƒíƒœë¥¼ ìƒì„±í•˜ê³  ëª¨ë“ˆ ìƒíƒœë¥¼ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì— ì—°ê²°í•˜ëŠ” APIë¥¼ ì œê³µí•œë‹¤. ëª¨ë“ˆ ìƒíƒœëŠ” ë³´í†µ ìƒíƒœ ë³€ìˆ˜ì— ì ‘ê·¼í•˜ê³  ê°±ì‹ í•˜ëŠ” ë©”ì„œë“œë¥¼ ê°€ì§„ store ê°ì²´ë¡œ ê°ì‹¼ë‹¤.

#### ì»´í¬ë„ŒíŠ¸ ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ ì´í•´í•˜ê¸°

ì»´í¬ë„ŒíŠ¸ ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ì—ì„œëŠ” ì»´í¬ë„ŒíŠ¸ ìƒëª… ì£¼ê¸° ë‚´ì—ì„œ ì „ì—­ ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” ê²ƒì´ ë” ì í•©í•˜ë‹¤. ì˜ì¡´í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ëª¨ë‘ ë§ˆìš´íŠ¸ í•´ì œë˜ë©´ ì „ì—­ ìƒíƒœë„ í•¨ê»˜ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸ì´ë‹¤. ì´ë¥¼ í™œìš©í•˜ë©´ ë…ë¦½ëœ ë‘ ê°œ ì´ìƒì˜ ì „ì—­ ìƒíƒœë¥¼ ë‘˜ ìˆ˜ ìˆëŠ”ë°, ê° ì „ì—­ ìƒíƒœëŠ” ì„œë¡œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ í•˜ìœ„ íŠ¸ë¦¬ì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ëŸ¬í•œ ì»´í¬ë„ŒíŠ¸ ì¤‘ì‹¬ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ”(ì•„ë§ˆ ì±…ì˜ ì´ ë¶€ë¶„ì—ì„œ ì˜¤íƒ€ê°€ ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤...) ì „ì—­ ìƒíƒœ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” íŒ©í† ë¦¬ í•¨ìˆ˜ë¥¼ ì œê³µí•˜ê³ , ì´ëŸ¬í•œ íŒ©í† ë¦¬ í•¨ìˆ˜ì—ì„œëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  ì „ì—­ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜ë¥¼ ìƒì„±í•œë‹¤.

### ë‘ ì ‘ê·¼ ë°©ì‹ì˜ ì˜ˆì™¸

1. ëª¨ë“ˆ ìƒíƒœëŠ” ëŒ€ì²´ë¡œ ì‹±ê¸€í†¤ìœ¼ë¡œ êµ¬í˜„ë˜ì§€ë§Œ í•˜ìœ„ íŠ¸ë¦¬ì— ëŒ€í•´ ì—¬ëŸ¬ ëª¨ë“ˆ ìƒíƒœë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤. ì‹¬ì§€ì–´ ëª¨ë“ˆ ìƒíƒœì˜ ìƒëª… ì£¼ê¸°ë¥¼ ì œì–´í•  ìˆ˜ë„ ìˆë‹¤.
2. ê³µê¸‰ì ì»´í¬ë„ŒíŠ¸ë¥¼ ìµœìƒìœ„ì— ë‘ê³  íŠ¸ë¦¬ê°€ í•˜ë‚˜ë§Œ ìˆìœ¼ë©´ ì‚¬ì‹¤ìƒ ì‹±ê¸€í†¤ì´ë‹¤.

### ë¦¬ë Œë”ë§ ìµœì í™”

ì „ì—­ ìƒíƒœì—ì„œ ë¦¬ë Œë”ë§ì„ í”¼í•˜ëŠ” ê²ƒì€ ì •ë§ ì¤‘ìš”í•œ ë¬¸ì œë‹¤. ìƒíƒœì˜ ì§ì ‘ ë³€ê²½ì„ ë§‰ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.

#### ì„ íƒì í•¨ìˆ˜ ì‚¬ìš©

ì„ íƒì í•¨ìˆ˜ëŠ” ìƒíƒœë¥¼ ë°›ì•„ ìƒíƒœì˜ ì¼ë¶€ë¥¼ ë°˜í™˜í•œë‹¤.

```tsx
// ì´ ì»´í¬ë„ŒíŠ¸ëŠ” state.b.c
const Component = () => {
  const value = useSelector((state) => state.b.c);
  return <>{value}</>;
};
```

useSelectorëŠ” ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì„ íƒì í•¨ìˆ˜ì˜ ê²°ê³¼ë¥¼ ë¹„êµí•˜ëŠ” ë° ì‚¬ìš©í•œë‹¤.

#### ì†ì„± ì ‘ê·¼ ê°ì§€

ì†ì„± ì ‘ê·¼ì„ ê°ì§€í•˜ê³  ê°ì§€í•œ ì •ë³´ë¥¼ ë Œë”ë§ ìµœì í™”ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒíƒœ ì‚¬ìš© ì¶”ì (state usage tracking)ì´ ìˆë‹¤.

```tsx
// ìƒíƒœ ì‚¬ìš© ì¶”ì  ê¸°ëŠ¥ì´ ìˆëŠ” useTrackedState í›… ì‚¬ìš©
const Component = () => {
  const trackedState = useTrackedState();
  return <p>{trackedState.b.c}</p>;
};
```

ì´ í›…ì„ í†µí•´ trackedStateê°€ .b.c ì†ì„±ì— ì ‘ê·¼í•œì§€ ì•Œ ìˆ˜ ìˆê³  .b.c ì†ì„± ê°’ì´ ë³€ê²½ë  ë•Œë§Œ useTrackedStateê°€ ë¦¬ë Œë”ë§ì„ ë°œìƒì‹œí‚¨ë‹¤. useSelectorê°€ ìˆ˜ë™ ë Œë”ë§ ìµœì í™” ë°©ì‹ì´ë¼ë©´ useTrackedStateëŠ” ìë™ ë Œë”ë§ ìµœì í™”ë‹¤.

useTrackedStateë¥¼ êµ¬í˜„í•˜ë ¤ë©´ ìƒíƒœ ê°ì²´ì— ëŒ€í•œ ì†ì„± ì ‘ê·¼ì„ í™•ì¸í•˜ê¸° ìœ„í•œ í”„ë¡ì‹œ ê°ì²´ê°€ í•„ìš”í•˜ë‹¤.(ğŸ‘‰ Vue.jsì—ì„œ ìƒíƒœ ë³€í™”ë¥¼ ê°ì§€í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì•Œê³  ìˆë‹¤!)

#### useSelectorì™€ useTrackedStateì˜ ì°¨ì´ì 

ê·¸ë ‡ë‹¤ê³  í•´ì„œ, ìë™ ë Œë”ë§ ìµœì í™”ê°€ ì™„ë²½í•˜ê²Œ ì‘ë™í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

```tsx
const Component = () => {
  const isSmall = useSelector((state) => state.a < 10);
  return <>{isSmall ? "small" : "big"}</>;
};

const Component = () => {
  const isSmall = useTrackedState().a < 10;
  return <>{isSmall ? "small" : "big"}</>;
};
```

ê¸°ëŠ¥ ë©´ì—ì„œ useTrackedStateë¥¼ ì‚¬ìš©í•œ ì»´í¬ë„ŒíŠ¸ëŠ” ì˜ ë™ì‘í•˜ì§€ë§Œ state.aê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë¦¬ë Œë”ë§ëœë‹¤. ë°˜ëŒ€ë¡œ useSelectorë¥¼ ì‚¬ìš©í•˜ë©´ isSmallì´ ë³€ê²½ë  ë•Œë§Œ ë¦¬ë Œë”ë§ë˜ë¯€ë¡œ useTrackedë³´ë‹¤ ë” ìµœì í™”ëë‹¤.

#### ì•„í†° ì‚¬ìš©

ì•„í†°ì€ ë¦¬ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ëŠ” ìµœì†Œ ìƒíƒœ ë‹¨ìœ„ë‹¤. ì „ì²´ ì „ì—­ ìƒíƒœë¥¼ êµ¬ë…í•´ì„œ ë¦¬ë Œë”ë§ì„ í”¼í•˜ëŠ” ëŒ€ì‹  ì•„í†°ì„ ì‚¬ìš©í•˜ë©´ ì¢€ ë” ì„¸ë¶„í™”í•´ì„œ êµ¬ë…í•  ìˆ˜ ìˆë‹¤.
